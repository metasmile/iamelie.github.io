<!DOCTYPE html>
<html>

<script type="text/javascript">
//<![CDATA[
function redirect(url) {
    var ua        = navigator.userAgent.toLowerCase(),
        isIE      = ua.indexOf('msie') !== -1,
        version   = parseInt(ua.substr(4, 2), 10);
    // Internet Explorer 8 and lower
    if (isIE && version < 9) {
        var link = document.createElement('a');
        link.href = url;
        document.body.appendChild(link);
        link.click();
    }
    // All other browsers can use the standard window.location.href (they don't lose HTTP_REFERER like IE8 & lower does)
    else {
        window.location.href = url;
    }
}
function langMatcher(format_lang, format_regions){
    // /^fr[-_](FR|CA)$/i or /^fr.*$/i
    return new RegExp(['^', format_lang, format_regions ? '[-_]('+format_regions.join('|')+')' : '.*', '$'].join(''), 'i');
}
function redirectIfMatch(){
    var langs = {"en":{"countries":["US","GB","AU"],"label":"English","path":"/"},"de":{"countries":["DE"],"label":"Deutsch","path":"/de"},"fr":{"countries":["FR","CA"],"label":"Français","path":"/fr"},"ja":{"countries":["JP"],"label":"日本語","path":"/ja"},"zh-Hans":{"countries":["CN","SG"],"label":"中文","path":"/zh-Hans"},"zh-Hant":{"countries":["HK","TW"],"label":"中文","path":"/zh-Hant"}};
    var language = window.navigator.userLanguage || window.navigator.language;
    var basepath = window.location.pathname && window.location.pathname.split('/')[1];
    if(basepath){
        for (var lang in langs){
            var l = lang.split('-');
            var lobj = langs[lang];
            //zh-Hans -> langMatcher(zh, ['Hans','CN','SG']);
            var matcher = langMatcher(l[0], l[1] && lobj.countries.concat(l[1]));
            if(basepath.replace(/^\s+|\s+$/g, '').match(matcher) || language.match(matcher)){
                redirect(lobj.path);
                return true;
            }
        }
    }
    redirect('/');
    return false;
}
redirectIfMatch();
//]]>
</script>

</html>
